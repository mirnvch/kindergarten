# ADR Template

**ADR** (Architecture Decision Record) — документ, фиксирующий важное архитектурное решение.

---

## Формат ADR

```markdown
# ADR-{номер}: {Название решения}

**Статус:** Proposed | Accepted | Deprecated | Superseded by ADR-XXX

**Дата:** YYYY-MM-DD

**Авторы:** @username

---

## Контекст

Какая проблема или задача стоит перед нами?
Какие ограничения существуют?
Какие факторы влияют на решение?

## Рассмотренные варианты

### Вариант 1: {Название}

**Описание:**
Краткое описание варианта.

**Плюсы:**

- Плюс 1
- Плюс 2

**Минусы:**

- Минус 1
- Минус 2

### Вариант 2: {Название}

**Описание:**
Краткое описание варианта.

**Плюсы:**

- Плюс 1
- Плюс 2

**Минусы:**

- Минус 1
- Минус 2

## Решение

Какой вариант выбран и почему?

## Последствия

### Положительные

- Что улучшится?

### Отрицательные

- Какие trade-offs?
- Что потребует дополнительной работы?

### Риски

- Какие риски несёт решение?
- Как их митигировать?

## Ссылки

- [Ссылка на обсуждение]()
- [Ссылка на документацию]()
```

---

## Когда создавать ADR

**Создавай ADR когда:**

- Выбираешь между технологиями (React Query vs SWR)
- Меняешь архитектурный паттерн
- Вводишь новую зависимость
- Меняешь структуру проекта
- Принимаешь решение с долгосрочными последствиями

**Не нужен ADR для:**

- Багфиксов
- Минорных рефакторингов
- Обновления зависимостей (без breaking changes)
- Стилистических изменений

---

## Нумерация

```
docs/architecture/adr/
├── template.md
├── 001-authentication-strategy.md
├── 002-database-choice.md
├── 003-state-management.md
└── ...
```

---

## Пример: ADR-001

```markdown
# ADR-001: Выбор стратегии аутентификации

**Статус:** Accepted

**Дата:** 2024-01-15

**Авторы:** @lead-developer

---

## Контекст

Нужно реализовать аутентификацию для приложения.
Требования:

- Поддержка email/password и OAuth (Google)
- JWT для stateless auth
- Совместимость с Edge Runtime (middleware)

## Рассмотренные варианты

### Вариант 1: NextAuth.js v5

**Описание:**
Официальная библиотека аутентификации для Next.js.

**Плюсы:**

- Официальная поддержка Next.js
- Встроенные провайдеры OAuth
- Edge-compatible (с ограничениями)

**Минусы:**

- v5 в beta
- Ограничения в Edge Runtime

### Вариант 2: Clerk

**Описание:**
Managed auth service.

**Плюсы:**

- Простая интеграция
- UI компоненты из коробки

**Минусы:**

- Vendor lock-in
- Стоимость при масштабировании

### Вариант 3: Custom JWT

**Описание:**
Собственная реализация на jose + bcrypt.

**Плюсы:**

- Полный контроль
- Нет зависимости от third-party

**Минусы:**

- Больше кода
- Риск security issues

## Решение

Выбран **NextAuth.js v5** потому что:

1. Официальная поддержка Next.js App Router
2. Активная разработка и сообщество
3. Достаточная гибкость для наших нужд

## Последствия

### Положительные

- Быстрый старт
- Проверенное решение
- Хорошая документация

### Отрицательные

- Beta статус v5
- Нужен workaround для Edge (отдельный config)

### Риски

- Breaking changes в v5
- Митигация: следить за changelog, писать тесты

## Ссылки

- [NextAuth.js v5 Docs](https://authjs.dev/)
- [Discussion #1234](https://github.com/...)
```

---

## Workflow

```
1. Identify      → Обнаружена необходимость архитектурного решения
       ↓
2. Draft         → Создать ADR в статусе "Proposed"
       ↓
3. Discuss       → Review в PR или meeting
       ↓
4. Decide        → Принять решение, обновить статус на "Accepted"
       ↓
5. Implement     → Реализовать решение
       ↓
6. Maintain      → При необходимости обновить на "Deprecated"
```

---

_См. также:_

- [Architecture Overview](../overview.md)
- [Data Flow](../data-flow.md)
