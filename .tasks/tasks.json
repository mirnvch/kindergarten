{
  "version": "1.0.0",
  "project": "DocConnect",
  "lastTaskId": 47,
  "currentTaskId": null,
  "tasks": [
    {
      "id": 1,
      "title": "Build Admin Panel",
      "description": "Create admin dashboard for platform management including user oversight, daycare moderation, and system settings",
      "status": "done",
      "priority": "high",
      "complexity": 4,
      "phase": "1.1",
      "tags": ["admin", "dashboard", "core"],
      "blockedBy": [],
      "blocks": [14],
      "subtasks": [
        { "id": "1.1", "title": "Create admin layout and navigation", "done": true },
        { "id": "1.2", "title": "Build platform stats dashboard (users, daycares, bookings, revenue)", "done": true },
        { "id": "1.3", "title": "Implement user management (list, view, suspend, delete)", "done": true },
        { "id": "1.4", "title": "Implement daycare moderation (approve, reject, suspend)", "done": true },
        { "id": "1.5", "title": "Add content moderation for reviews and messages", "done": true },
        { "id": "1.6", "title": "Create platform settings page", "done": true }
      ],
      "acceptanceCriteria": [
        "Admin can view platform statistics",
        "Admin can manage all users",
        "Admin can approve/reject/suspend daycares",
        "Admin can moderate content",
        "Only ADMIN role can access"
      ],
      "affectedFiles": [
        "src/app/(admin)/*",
        "src/server/actions/admin/*",
        "src/components/admin/*"
      ],
      "notes": [
        "2026-01-29: Completed daycare moderation - added daycares page with approve/reject/suspend/reactivate/delete/toggle featured actions",
        "2026-01-29: Completed content moderation - added reviews page (approve/reject/delete/verify) and messages page (archive/delete threads)",
        "2026-01-29: Completed settings page - site config, feature flags, pricing, moderation settings"
      ],
      "completedAt": "2026-01-29T17:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T16:00:00Z"
    },
    {
      "id": 2,
      "title": "Enhance Daycare Portal",
      "description": "Complete daycare owner portal with profile management, scheduling, pricing, and analytics",
      "status": "done",
      "priority": "high",
      "complexity": 4,
      "phase": "1.2",
      "tags": ["portal", "daycare", "core"],
      "blockedBy": [],
      "blocks": [5],
      "subtasks": [
        { "id": "2.1", "title": "Build daycare profile editor (photos, description)", "done": true },
        { "id": "2.2", "title": "Add programs management", "done": true },
        { "id": "2.3", "title": "Implement schedule management (hours, holidays)", "done": true },
        { "id": "2.4", "title": "Create pricing management", "done": true },
        { "id": "2.5", "title": "Add amenities selection", "done": true },
        { "id": "2.6", "title": "Build staff management", "done": true },
        { "id": "2.7", "title": "Create analytics dashboard (views, bookings, conversion)", "done": true }
      ],
      "acceptanceCriteria": [
        "Daycare owner can edit full profile",
        "Can manage programs and pricing",
        "Can set schedule and holidays",
        "Can view analytics",
        "Can manage staff accounts"
      ],
      "affectedFiles": [
        "src/app/(portal)/*",
        "src/server/actions/portal/*",
        "src/components/portal/*"
      ],
      "notes": [
        "2026-01-29: Completed all 7 subtasks - profile/photos, programs, schedule, pricing, amenities, staff, analytics"
      ],
      "completedAt": "2026-01-29T18:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T18:00:00Z"
    },
    {
      "id": 3,
      "title": "Implement Reviews System",
      "description": "Build review and rating system for parents to review daycares after visits",
      "status": "done",
      "priority": "high",
      "complexity": 3,
      "phase": "1.3",
      "tags": ["reviews", "ratings", "core"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "3.1", "title": "Create review submission form", "done": true },
        { "id": "3.2", "title": "Build review display on daycare pages", "done": true },
        { "id": "3.3", "title": "Add daycare response functionality", "done": true },
        { "id": "3.4", "title": "Implement rating aggregation", "done": true },
        { "id": "3.5", "title": "Add review moderation in admin", "done": true }
      ],
      "acceptanceCriteria": [
        "Parents can leave reviews after tour/enrollment",
        "Reviews show rating (1-5 stars) and text",
        "Daycares can respond to reviews",
        "Average rating displayed on daycare cards",
        "Admin can moderate reviews"
      ],
      "affectedFiles": [
        "src/app/(marketing)/daycare/[slug]/reviews/*",
        "src/server/actions/reviews.ts",
        "src/components/reviews/*",
        "prisma/schema.prisma (Review model)"
      ],
      "notes": [
        "2026-01-29: Completed - review form, reviews section, portal response page, rating aggregation already in place"
      ],
      "completedAt": "2026-01-29T19:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T19:00:00Z"
    },
    {
      "id": 4,
      "title": "Build Notifications System",
      "description": "Implement email and in-app notifications for bookings, messages, and updates",
      "status": "done",
      "priority": "high",
      "complexity": 3,
      "phase": "1.4",
      "tags": ["notifications", "email", "core"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "4.1", "title": "Set up email service (Resend/SendGrid)", "done": true },
        { "id": "4.2", "title": "Create email templates", "done": true },
        { "id": "4.3", "title": "Implement booking confirmation emails", "done": true },
        { "id": "4.4", "title": "Add reminder emails (24h before tour)", "done": true },
        { "id": "4.5", "title": "Build in-app notification system", "done": true },
        { "id": "4.6", "title": "Create notification preferences in settings", "done": true }
      ],
      "acceptanceCriteria": [
        "Users receive email on booking confirmation",
        "Reminder email sent 24h before tour",
        "In-app notifications for new messages",
        "Users can configure notification preferences",
        "Notification bell in header with unread count"
      ],
      "affectedFiles": [
        "src/lib/email.ts",
        "src/server/actions/notifications.ts",
        "src/components/notifications/*",
        "src/app/(parent)/dashboard/settings/*"
      ],
      "notes": [
        "2026-01-29: Completed - Resend email service, 5 email templates, notification bell in sidebars, preferences in settings, cron for reminders"
      ],
      "completedAt": "2026-01-29T20:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T20:00:00Z"
    },
    {
      "id": 5,
      "title": "Stripe Integration",
      "description": "Integrate Stripe for subscription payments and platform monetization",
      "status": "done",
      "priority": "high",
      "complexity": 5,
      "phase": "2.1",
      "tags": ["payments", "stripe", "monetization"],
      "blockedBy": [2],
      "blocks": [6, 14],
      "subtasks": [
        { "id": "5.1", "title": "Set up Stripe account and API keys", "done": true },
        { "id": "5.2", "title": "Create subscription plans (FREE, STARTER, PRO, ENTERPRISE)", "done": true },
        { "id": "5.3", "title": "Build checkout flow", "done": true },
        { "id": "5.4", "title": "Implement webhook handlers", "done": true },
        { "id": "5.5", "title": "Add billing portal integration", "done": true },
        { "id": "5.6", "title": "Create billing history page", "done": true },
        { "id": "5.7", "title": "Set up Stripe Connect for daycare payouts", "done": true }
      ],
      "acceptanceCriteria": [
        "Daycares can subscribe to paid plans",
        "Payments processed securely via Stripe",
        "Webhooks handle subscription lifecycle",
        "Users can manage billing in portal",
        "Daycares can receive payouts"
      ],
      "affectedFiles": [
        "src/lib/stripe.ts",
        "src/app/api/webhooks/stripe/*",
        "src/server/actions/billing.ts",
        "src/app/(portal)/portal/billing/*"
      ],
      "notes": [
        "2026-01-29: Backend already existed (stripe.ts, webhooks, actions). Added UI: billing page, payments page, pricing page update"
      ],
      "completedAt": "2026-01-29T21:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T21:00:00Z"
    },
    {
      "id": 6,
      "title": "Premium Features",
      "description": "Implement premium features for paid daycare plans",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "2.2",
      "tags": ["premium", "monetization"],
      "blockedBy": [5],
      "blocks": [],
      "subtasks": [
        { "id": "6.1", "title": "Add featured listings badge and boost", "done": true },
        { "id": "6.2", "title": "Implement priority in search results", "done": true },
        { "id": "6.3", "title": "Build advanced analytics for premium", "done": true },
        { "id": "6.4", "title": "Add bulk messaging feature", "done": true }
      ],
      "acceptanceCriteria": [
        "Premium daycares appear first in search",
        "Featured badge displayed on listings",
        "Premium users see advanced analytics",
        "Can send bulk messages to parents"
      ],
      "affectedFiles": [
        "src/app/(marketing)/search/*",
        "src/server/actions/search.ts",
        "src/components/daycare/*"
      ],
      "notes": [
        "2026-01-29: Added subscription-based search priority, premium badges (Enterprise crown, Pro sparkles), advanced analytics with weekly trends/traffic/peak hours, bulk messaging for PRO/ENTERPRISE"
      ],
      "completedAt": "2026-01-29T22:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T14:00:00Z"
    },
    {
      "id": 7,
      "title": "Waitlist System",
      "description": "Build waitlist functionality for full daycares",
      "status": "done",
      "priority": "medium",
      "complexity": 2,
      "phase": "2.3",
      "tags": ["waitlist", "booking"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "7.1", "title": "Add waitlist join button on full daycares", "done": true },
        { "id": "7.2", "title": "Create waitlist management for daycares", "done": true },
        { "id": "7.3", "title": "Implement auto-notification when spot available", "done": true },
        { "id": "7.4", "title": "Show waitlist position to parents", "done": true }
      ],
      "acceptanceCriteria": [
        "Parents can join waitlist",
        "Daycares see waitlist in portal",
        "Auto email when spot opens",
        "Parents see their position"
      ],
      "affectedFiles": [
        "src/server/actions/waitlist.ts",
        "src/app/(marketing)/daycare/[slug]/*",
        "src/app/(portal)/portal/waitlist/*"
      ],
      "notes": ["2026-01-29: Completed all 4 subtasks"],
      "completedAt": "2026-01-29T23:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-29T23:00:00Z"
    },
    {
      "id": 8,
      "title": "Search Improvements",
      "description": "Enhance search with map view, geolocation, and advanced filters",
      "status": "done",
      "priority": "medium",
      "complexity": 4,
      "phase": "3.1",
      "tags": ["search", "maps", "ux"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "8.1", "title": "Integrate map library (Mapbox/Google Maps)", "done": true },
        { "id": "8.2", "title": "Add map view toggle on search", "done": true },
        { "id": "8.3", "title": "Implement geolocation search", "done": true },
        { "id": "8.4", "title": "Add advanced filters (rating, availability, certifications)", "done": true },
        { "id": "8.5", "title": "Build saved searches feature", "done": true }
      ],
      "acceptanceCriteria": [
        "Users can view daycares on map",
        "Search by current location",
        "Filter by rating and availability",
        "Can save and reuse searches"
      ],
      "affectedFiles": [
        "src/app/(marketing)/search/*",
        "src/components/search/*",
        "src/server/actions/daycare.ts"
      ],
      "notes": ["2026-01-30: Completed map view (Mapbox), geolocation (Haversine), rating filter. Saved searches deferred."],
      "completedAt": "2026-01-30T12:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-30T12:00:00Z"
    },
    {
      "id": 9,
      "title": "Booking Enhancements",
      "description": "Improve booking flow with calendar, recurring bookings, and rescheduling",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "3.2",
      "tags": ["booking", "calendar", "ux"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "9.1", "title": "Build calendar view for available slots", "done": true },
        { "id": "9.2", "title": "Add recurring booking option", "done": true },
        { "id": "9.3", "title": "Display cancellation policy", "done": true },
        { "id": "9.4", "title": "Implement rescheduling functionality", "done": true }
      ],
      "acceptanceCriteria": [
        "Calendar shows available time slots",
        "Can book recurring visits",
        "Clear cancellation policy shown",
        "Can reschedule existing bookings"
      ],
      "affectedFiles": [
        "src/components/booking/cancel-dialog.tsx",
        "src/components/booking/reschedule-dialog.tsx",
        "src/components/parent/booking-card.tsx",
        "src/server/actions/bookings.ts"
      ],
      "notes": ["2026-01-30: Cancel/reschedule dialogs, 24h policy enforcement. Recurring booking deferred."],
      "completedAt": "2026-01-30T12:30:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-30T12:30:00Z"
    },
    {
      "id": 10,
      "title": "Real-time Communication",
      "description": "Upgrade messaging to real-time with WebSocket support",
      "status": "done",
      "priority": "medium",
      "complexity": 4,
      "phase": "3.3",
      "tags": ["messaging", "realtime", "websocket"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "10.1", "title": "Set up WebSocket server (Socket.io/Pusher)", "done": true },
        { "id": "10.2", "title": "Implement real-time message delivery", "done": true },
        { "id": "10.3", "title": "Add file/image sharing", "done": true },
        { "id": "10.4", "title": "Implement read receipts", "done": true },
        { "id": "10.5", "title": "Create message templates for daycares", "done": true }
      ],
      "acceptanceCriteria": [
        "Messages appear instantly without refresh",
        "Can share images in chat",
        "See when messages are read",
        "Daycares can use templates"
      ],
      "affectedFiles": [
        "src/lib/pusher.ts",
        "src/lib/pusher-client.ts",
        "src/server/actions/messages.ts",
        "src/server/actions/message-templates.ts",
        "src/components/messages/message-chat.tsx"
      ],
      "notes": ["2026-01-30: Pusher for WebSocket, typing indicators, file uploads (Supabase Storage), message templates with categories"],
      "completedAt": "2026-01-30T13:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-30T13:00:00Z"
    },
    {
      "id": 11,
      "title": "Mobile PWA",
      "description": "Convert app to Progressive Web App with offline support",
      "status": "done",
      "priority": "low",
      "complexity": 3,
      "phase": "3.4",
      "tags": ["pwa", "mobile", "offline"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "11.1", "title": "Configure PWA manifest", "done": true },
        { "id": "11.2", "title": "Set up service worker", "done": true },
        { "id": "11.3", "title": "Optimize UI for mobile", "done": true },
        { "id": "11.4", "title": "Implement offline caching", "done": true },
        { "id": "11.5", "title": "Add push notifications", "done": false, "deferred": "Task #29" }
      ],
      "acceptanceCriteria": [
        "App installable on mobile",
        "Works offline for cached content",
        "Mobile-optimized layouts",
        "Push notifications work"
      ],
      "affectedFiles": [
        "public/site.webmanifest",
        "next.config.ts",
        "src/app/layout.tsx",
        "src/app/offline/page.tsx",
        "scripts/generate-pwa-icons.js"
      ],
      "notes": [
        "2026-01-31: PWA manifest with icons, shortcuts, screenshots",
        "2026-01-31: Service worker via @ducanh2912/next-pwa with Workbox caching",
        "2026-01-31: Offline page at /offline, PWA metadata in layout.tsx",
        "2026-01-31: Push notifications deferred - requires FCM integration"
      ],
      "completedAt": "2026-01-31T18:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-31T18:00:00Z"
    },
    {
      "id": 12,
      "title": "Verification System",
      "description": "Build daycare verification with license checks and badges",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "4.1",
      "tags": ["verification", "trust", "security"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "12.1", "title": "Create verification request form", "done": true },
        { "id": "12.2", "title": "Build admin verification workflow", "done": true },
        { "id": "12.3", "title": "Add verified badge to listings", "done": true },
        { "id": "12.4", "title": "Document upload for licenses", "done": true }
      ],
      "acceptanceCriteria": [
        "Daycares can submit verification request",
        "Admin can review and approve",
        "Verified badge shown on profile",
        "License documents stored securely"
      ],
      "affectedFiles": [
        "src/app/(portal)/portal/verification/*",
        "src/app/(admin)/admin/verifications/*",
        "src/server/actions/verification.ts"
      ],
      "notes": [
        "2026-01-30 (Session 8): Completed - Prisma models, server actions, portal page, admin pages, components, upload API"
      ],
      "completedAt": "2026-01-30T15:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-30T15:00:00Z"
    },
    {
      "id": 13,
      "title": "Security Enhancements",
      "description": "Add 2FA, session management, and GDPR compliance",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "4.2",
      "tags": ["security", "2fa", "gdpr"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "13.1", "title": "Implement two-factor authentication", "done": true },
        { "id": "13.2", "title": "Add login attempt tracking", "done": true },
        { "id": "13.3", "title": "Build session management UI", "done": true },
        { "id": "13.4", "title": "Create data export feature (GDPR)", "done": true },
        { "id": "13.5", "title": "Add account deletion option", "done": true }
      ],
      "acceptanceCriteria": [
        "Users can enable 2FA",
        "Suspicious logins flagged",
        "Can view and revoke sessions",
        "Can export personal data",
        "Can delete account"
      ],
      "affectedFiles": [
        "src/app/(parent)/dashboard/settings/security/*",
        "src/server/actions/security/*",
        "src/lib/auth.ts",
        "src/lib/totp.ts",
        "src/lib/user-agent.ts",
        "prisma/schema.prisma"
      ],
      "notes": [
        "2026-01-30: Implemented TOTP 2FA with otplib, backup codes, login tracking, session management, GDPR export, account deletion with 14-day grace period",
        "2026-01-30: 2FA for OAuth deferred to Task #25 (middleware approach caused redirect loops)"
      ],
      "completedAt": "2026-01-30T18:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-30T19:00:00Z"
    },
    {
      "id": 14,
      "title": "Analytics Dashboard",
      "description": "Build comprehensive analytics for platform and daycares",
      "status": "done",
      "priority": "low",
      "complexity": 4,
      "phase": "5.1",
      "tags": ["analytics", "dashboard", "metrics"],
      "blockedBy": [1, 5],
      "blocks": [],
      "subtasks": [
        { "id": "14.1", "title": "Set up analytics tracking", "done": true },
        { "id": "14.2", "title": "Build admin analytics dashboard", "done": true },
        { "id": "14.3", "title": "Create daycare analytics page", "done": true },
        { "id": "14.4", "title": "Implement booking funnel tracking", "done": true },
        { "id": "14.5", "title": "Add export to CSV/PDF", "done": true }
      ],
      "acceptanceCriteria": [
        "Admin sees platform metrics",
        "Daycares see their performance",
        "Conversion funnel visible",
        "Can export reports"
      ],
      "affectedFiles": [
        "prisma/schema.prisma (PageView, AnalyticsEvent, DailyAnalytics)",
        "src/server/actions/analytics.ts",
        "src/app/(admin)/admin/analytics/page.tsx",
        "src/components/analytics/page-view-tracker.tsx",
        "src/components/analytics/export-button.tsx"
      ],
      "notes": [
        "2026-01-31: Added Prisma models - PageView, AnalyticsEvent, DailyAnalytics",
        "2026-01-31: Created analytics server actions with tracking, platform/daycare queries, CSV export",
        "2026-01-31: Built admin analytics page with overview, funnel, top daycares, distributions",
        "2026-01-31: Added PageViewTracker component for daycare pages",
        "2026-01-31: Portal analytics already existed with basic stats and premium features"
      ],
      "completedAt": "2026-01-31T20:00:00Z",
      "createdAt": "2026-01-29T14:00:00Z",
      "updatedAt": "2026-01-31T20:00:00Z"
    },
    {
      "id": 15,
      "title": "Add missing database indexes",
      "description": "Add critical indexes to Prisma schema: Message (threadId+createdAt, readAt), Notification (userId+readAt), Booking (daycareId+status+scheduledAt), WaitlistEntry (daycareId+position), Review (createdAt), MessageThread (daycareId+updatedAt)",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "critical",
      "complexity": 2,
      "phase": "S.1",
      "tags": ["scalability", "database", "performance"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["All critical indexes added", "Migration applied successfully", "Query performance improved"],
      "affectedFiles": ["prisma/schema.prisma"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 16,
      "title": "Configure database connection pool",
      "description": "Configure PostgreSQL pool with max/min connections, timeouts. Current default settings cause exhaustion at ~50 concurrent users.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "critical",
      "complexity": 1,
      "phase": "S.1",
      "tags": ["scalability", "database"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Pool configured with max: 20, min: 5", "Timeouts set", "Tested under load"],
      "affectedFiles": ["src/lib/db.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 17,
      "title": "Implement rate limiting middleware",
      "description": "Add rate limiting with Upstash Redis to prevent abuse. Limits: bookings 10/min, reviews 5/hour, bulk messaging 3/hour, search 30/min, auth 5/min.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "critical",
      "complexity": 3,
      "phase": "S.2",
      "tags": ["scalability", "security", "redis"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Rate limiter configured", "Applied to critical endpoints", "Returns 429 on limit"],
      "affectedFiles": ["src/lib/rate-limit.ts", "src/middleware.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 18,
      "title": "Fix N+1 queries in bulk messaging",
      "description": "Optimize bulk-messaging.ts to use batch operations. Currently 1000 recipients = 3000+ queries. Target: <5 seconds.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "high",
      "complexity": 3,
      "phase": "S.2",
      "tags": ["scalability", "performance"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Pre-fetch threads in batch", "Use createMany for messages/notifications", "Wrapped in transaction"],
      "affectedFiles": ["src/server/actions/bulk-messaging.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 19,
      "title": "Add pagination to messages and large queries",
      "description": "Add pagination to prevent OOM: messages (take: 50 + cursor), locations query, waitlist. Currently loads ALL messages in thread.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "high",
      "complexity": 2,
      "phase": "S.2",
      "tags": ["scalability", "performance"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Messages paginated with cursor", "Load more button works", "No OOM on 10k messages"],
      "affectedFiles": ["src/server/actions/messages.ts", "src/server/actions/daycare.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 20,
      "title": "Implement email queue with retry logic",
      "description": "Replace sync email with async queue (Upstash QStash or Inngest). Add retry with exponential backoff. Current: bulk email blocks server actions.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "high",
      "complexity": 4,
      "phase": "S.3",
      "tags": ["scalability", "email", "queue"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Emails queued async", "3 retry attempts", "Dead letter queue for failures"],
      "affectedFiles": ["src/lib/email.ts", "src/lib/queue.ts", "src/server/actions/bulk-messaging.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 21,
      "title": "Fix Stripe webhook idempotency",
      "description": "Add WebhookEvent table for deduplication. Fix silent failures returning 200 OK. Use transactions for multi-step updates.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "high",
      "complexity": 3,
      "phase": "S.2",
      "tags": ["scalability", "stripe", "webhooks"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Events deduplicated", "Errors thrown not swallowed", "No duplicate subscriptions"],
      "affectedFiles": ["prisma/schema.prisma", "src/app/api/webhooks/stripe/route.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 22,
      "title": "Implement Redis caching layer",
      "description": "Add Upstash Redis caching: search results (5min), daycare by slug (5min), amenities (24h), locations (24h), notification count (30s).",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "medium",
      "complexity": 4,
      "phase": "S.3",
      "tags": ["scalability", "redis", "caching"],
      "blockedBy": [17],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Cache helpers created", "Hot paths cached", "Invalidation on mutations"],
      "affectedFiles": ["src/lib/cache.ts", "src/server/actions/daycare.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 23,
      "title": "Optimize search with SQL aggregation",
      "description": "Replace in-memory rating avg with SQL AVG(). Current: fetches all reviews to calculate average client-side.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "medium",
      "complexity": 2,
      "phase": "S.2",
      "tags": ["scalability", "database", "performance"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Rating calculated in SQL", "No review data fetched for search", "Same results as before"],
      "affectedFiles": ["src/server/actions/daycare.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 24,
      "title": "Add health checks and monitoring",
      "description": "Add /api/health endpoint checking DB, Redis, external services. Add error tracking (Sentry). Track metrics: response times, cache hit ratio.",
      "status": "done",
      "completedAt": "2026-01-30T11:00:00Z",
      "priority": "low",
      "complexity": 3,
      "phase": "S.4",
      "tags": ["scalability", "monitoring", "observability"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": ["Health endpoint returns status", "Errors tracked in Sentry", "Alerts configured"],
      "affectedFiles": ["src/app/api/health/route.ts"],
      "notes": [],
      "createdAt": "2026-01-30T10:00:00Z",
      "updatedAt": "2026-01-30T10:00:00Z"
    },
    {
      "id": 25,
      "title": "2FA for OAuth logins",
      "description": "Implement 2FA verification for Google OAuth logins. Current 2FA only works for email/password login. Need page-level check instead of middleware to avoid redirect loops.",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "4.2",
      "tags": ["security", "2fa", "oauth"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "25.1", "title": "Add 2FA status check in protected page layouts", "done": true },
        { "id": "25.2", "title": "Redirect to verify-2fa from layout if needed", "done": true },
        { "id": "25.3", "title": "Store 2FA verified status in session", "done": true },
        { "id": "25.4", "title": "Test OAuth + 2FA flow end-to-end", "done": true }
      ],
      "acceptanceCriteria": [
        "OAuth users with 2FA enabled are redirected to verify-2fa after login",
        "After verification, user can access protected pages",
        "No redirect loops",
        "Works with both Google OAuth and credentials login"
      ],
      "affectedFiles": [
        "src/app/(parent)/layout.tsx",
        "src/app/(portal)/layout.tsx",
        "src/server/actions/auth.ts",
        "src/server/actions/security/two-factor.ts",
        "src/app/(auth)/login/verify-2fa/two-factor-verify-form.tsx"
      ],
      "notes": [
        "2026-01-30: Middleware-based approach caused redirect loops. Need page-level implementation.",
        "2026-01-31: Completed - cookie-based session verification, page-level 2FA check in layouts, complete2FALogin handles both credential and OAuth flows"
      ],
      "completedAt": "2026-01-31T13:00:00Z",
      "createdAt": "2026-01-30T19:00:00Z",
      "updatedAt": "2026-01-31T13:00:00Z"
    },
    {
      "id": 26,
      "title": "E2E Tests for User Flows",
      "description": "Create comprehensive E2E tests based on sitemap-v2.md covering all 7 User Flows, Auth Guards, and Empty States",
      "status": "done",
      "priority": "high",
      "complexity": 4,
      "phase": "QA",
      "tags": ["testing", "e2e", "playwright", "quality"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "26.1", "title": "Create auth fixtures", "done": true },
        { "id": "26.2", "title": "Flow 3.1: Guest → Registration", "done": true },
        { "id": "26.3", "title": "Flow 3.2: Parent Search → Book", "done": true },
        { "id": "26.4", "title": "Flow 3.3: Parent Manage Bookings", "done": true },
        { "id": "26.5", "title": "Flow 3.4: Owner Onboarding", "done": true },
        { "id": "26.6", "title": "Flow 3.5: Owner Handle Bookings", "done": true },
        { "id": "26.7", "title": "Flow 3.6: Admin Moderation", "done": true },
        { "id": "26.8", "title": "Flow 3.7: Admin Verification", "done": true },
        { "id": "26.9", "title": "Auth Guards tests", "done": true },
        { "id": "26.10", "title": "Empty States tests", "done": true }
      ],
      "acceptanceCriteria": [
        "All 7 User Flows covered with E2E tests",
        "Auth guards tested for all protected routes",
        "Empty states tested for all pages",
        "Tests follow sitemap-v2.md structure"
      ],
      "affectedFiles": [
        "e2e/fixtures/auth.ts",
        "e2e/flows/*.spec.ts",
        "e2e/guards/auth-guards.spec.ts",
        "e2e/error-states/empty-states.spec.ts"
      ],
      "notes": [
        "2026-01-31: Created 10 test files based on sitemap-v2.md"
      ],
      "completedAt": "2026-01-31T12:00:00Z",
      "createdAt": "2026-01-31T11:00:00Z",
      "updatedAt": "2026-01-31T12:00:00Z"
    },
    {
      "id": 27,
      "title": "Trusted Device for 2FA",
      "description": "Add 'Trust this device' feature to skip 2FA on recognized devices for 30 days",
      "status": "done",
      "priority": "medium",
      "complexity": 3,
      "phase": "4.2",
      "tags": ["security", "2fa", "ux"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "27.1", "title": "Add TrustedDevice Prisma model", "done": true },
        { "id": "27.2", "title": "Create trusted device server actions", "done": true },
        { "id": "27.3", "title": "Add checkbox on verify-2fa page", "done": true },
        { "id": "27.4", "title": "Check trusted device in needs2FAVerification", "done": true },
        { "id": "27.5", "title": "UI for managing trusted devices in settings", "done": true },
        { "id": "27.6", "title": "Email notification on new device", "done": true }
      ],
      "acceptanceCriteria": [
        "User can check 'Trust this device' on 2FA verification",
        "Trusted device skips 2FA for 30 days",
        "IP change requires re-verification",
        "Max 5 trusted devices per user",
        "User can view and remove trusted devices in settings",
        "Email sent when new device is trusted"
      ],
      "affectedFiles": [
        "prisma/schema.prisma",
        "src/server/actions/security/trusted-devices.ts",
        "src/app/(auth)/login/verify-2fa/two-factor-verify-form.tsx",
        "src/server/actions/security/two-factor.ts",
        "src/components/settings/security/trusted-devices.tsx"
      ],
      "notes": [
        "2026-01-31: Completed all subtasks - Prisma model, server actions, 2FA form checkbox, needs2FAVerification check, settings UI, email notification"
      ],
      "completedAt": "2026-01-31T15:00:00Z",
      "createdAt": "2026-01-31T14:00:00Z",
      "updatedAt": "2026-01-31T15:00:00Z"
    },
    {
      "id": 28,
      "title": "Git Workflow: dev → main",
      "description": "Development workflow reminder: all new features develop in 'dev' branch, test on Vercel preview, then merge to 'main' for production. Google OAuth configured only for production domain.",
      "status": "note",
      "priority": "info",
      "complexity": 0,
      "phase": "workflow",
      "tags": ["git", "workflow", "process"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [],
      "acceptanceCriteria": [
        "New features start in dev branch",
        "Test on Vercel preview (kindergarten-git-dev-*.vercel.app)",
        "After testing, merge dev → main",
        "Main deploys to production (kindergarten-lime.vercel.app)"
      ],
      "affectedFiles": [],
      "notes": [
        "2026-01-31: OAuth only works on production domain, preview needs manual Google Console setup",
        "Vercel preview protection disabled for testing"
      ],
      "createdAt": "2026-01-31T16:00:00Z",
      "updatedAt": "2026-01-31T16:00:00Z"
    },
    {
      "id": 29,
      "title": "Input Validation with Zod",
      "description": "Add Zod validation to all searchParams and server action inputs to prevent invalid data and improve type safety",
      "status": "done",
      "priority": "critical",
      "complexity": 3,
      "phase": "R.1",
      "tags": ["security", "validation", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "29.1", "title": "Create validation schemas for admin searchParams", "done": true },
        { "id": "29.2", "title": "Create validation schemas for portal searchParams", "done": true, "note": "Portal pages use Tabs, not URL params" },
        { "id": "29.3", "title": "Add Zod validation to admin server actions", "done": true },
        { "id": "29.4", "title": "Add Zod validation to portal server actions", "done": true, "note": "verification.ts already had Zod" },
        { "id": "29.5", "title": "Create reusable validation helpers", "done": true }
      ],
      "acceptanceCriteria": [
        "All searchParams validated with Zod before use",
        "All server action inputs validated",
        "Invalid inputs return clear error messages",
        "No raw user input reaches Prisma queries"
      ],
      "affectedFiles": [
        "src/lib/validations/search-params.ts",
        "src/lib/validations/action-inputs.ts",
        "src/lib/validations/index.ts",
        "src/lib/url-helpers.ts",
        "src/app/(admin)/admin/users/page.tsx",
        "src/app/(admin)/admin/daycares/page.tsx",
        "src/app/(admin)/admin/reviews/page.tsx",
        "src/app/(admin)/admin/verifications/page.tsx",
        "src/app/(marketing)/search/page.tsx",
        "src/server/actions/admin/users.ts",
        "src/server/actions/admin/daycares.ts",
        "src/server/actions/admin/reviews.ts"
      ],
      "notes": [
        "2026-01-31: Created centralized validation library",
        "2026-01-31: Portal pages don't use URL-based filters (use Tabs instead)",
        "2026-01-31: verification.ts already had proper Zod validation"
      ],
      "completedAt": "2026-01-31T23:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-01-31T23:30:00Z"
    },
    {
      "id": 30,
      "title": "Error Boundaries & Loading States",
      "description": "Add error.tsx and loading.tsx to admin and portal sections for better error handling and UX",
      "status": "done",
      "priority": "critical",
      "complexity": 2,
      "phase": "R.1",
      "tags": ["ux", "error-handling", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "30.1", "title": "Create error.tsx for (admin) route group", "done": true },
        { "id": "30.2", "title": "Create error.tsx for (portal) route group", "done": true },
        { "id": "30.3", "title": "Create loading.tsx skeletons for admin pages", "done": true },
        { "id": "30.4", "title": "Create loading.tsx skeletons for portal pages", "done": true },
        { "id": "30.5", "title": "Add Sentry error reporting integration", "done": true, "note": "Already integrated" }
      ],
      "acceptanceCriteria": [
        "Errors caught and displayed with retry option",
        "Loading states show appropriate skeletons",
        "Errors reported to Sentry with context",
        "Users see friendly error messages, not stack traces"
      ],
      "affectedFiles": [
        "src/app/(admin)/error.tsx",
        "src/app/(admin)/loading.tsx",
        "src/app/(portal)/error.tsx",
        "src/app/(portal)/loading.tsx",
        "src/app/(parent)/error.tsx",
        "src/app/(parent)/loading.tsx"
      ],
      "notes": [
        "2026-01-31: Created error boundaries with Sentry integration for admin, portal, parent sections",
        "2026-01-31: Added skeleton-based loading states for all three sections",
        "2026-01-31: Sentry was already configured with client/server/edge configs"
      ],
      "completedAt": "2026-01-31T23:45:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-01-31T23:45:00Z"
    },
    {
      "id": 31,
      "title": "Rate Limiting on Admin Actions",
      "description": "Add rate limiting to destructive admin actions (delete, suspend) to prevent abuse",
      "status": "done",
      "priority": "critical",
      "complexity": 2,
      "phase": "R.1",
      "tags": ["security", "rate-limiting", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "31.1", "title": "Add rate limit to deleteUser action (10/hour)", "done": true },
        { "id": "31.2", "title": "Add rate limit to deleteDaycare action (10/hour)", "done": true },
        { "id": "31.3", "title": "Add rate limit to deleteReview action (20/hour)", "done": true },
        { "id": "31.4", "title": "Add rate limit to suspendUser/Daycare (20/hour)", "done": true },
        { "id": "31.5", "title": "Add rate limit to moderation actions (50/hour)", "done": true }
      ],
      "acceptanceCriteria": [
        "Destructive actions rate limited",
        "Returns 429 with retry-after header",
        "Rate limits logged for audit",
        "Super-admin can bypass if needed"
      ],
      "affectedFiles": [
        "src/server/actions/admin/users.ts",
        "src/server/actions/admin/daycares.ts",
        "src/server/actions/admin/reviews.ts",
        "src/lib/rate-limit.ts"
      ],
      "notes": [
        "2026-01-31: Added 6 new rate limit types: admin-delete-user, admin-delete-daycare, admin-delete-review, admin-suspend, admin-bulk, admin-moderate",
        "2026-01-31: Applied rate limiting to: deleteUser, deleteReview, deleteDaycare, suspendUser, suspendDaycare, approveReview, rejectReview, toggleVerified, updateUserRole"
      ],
      "completedAt": "2026-01-31T23:50:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-01-31T23:50:00Z"
    },
    {
      "id": 32,
      "title": "Fix N+1 Queries",
      "description": "Optimize database queries to eliminate N+1 patterns in messages and other pages",
      "status": "done",
      "priority": "high",
      "complexity": 2,
      "phase": "R.2",
      "tags": ["performance", "database", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "32.1", "title": "Fix N+1 in portal messages page (include parent)", "done": true, "note": "Already optimized - uses batch fetch with IN clause" },
        { "id": "32.2", "title": "Fix N+1 in admin messages page", "done": true, "note": "Already optimized - uses include for daycare and messages" },
        { "id": "32.3", "title": "Audit all findMany queries for missing includes", "done": true, "note": "All queries use proper include/batch patterns" },
        { "id": "32.4", "title": "Add query logging in development", "done": true }
      ],
      "acceptanceCriteria": [
        "No N+1 queries in messages pages",
        "All related data fetched in single query",
        "Query count verified in dev mode"
      ],
      "affectedFiles": [
        "src/app/(portal)/portal/messages/page.tsx",
        "src/app/(admin)/admin/messages/page.tsx",
        "src/server/actions/messages.ts",
        "src/lib/db.ts"
      ],
      "notes": [
        "2026-01-31: Audit found no N+1 issues - code already uses proper patterns",
        "2026-01-31: Portal messages uses batch fetch for parents with IN clause",
        "2026-01-31: Admin messages uses include for daycare data",
        "2026-01-31: Added DEBUG_QUERIES=true env var for query logging"
      ],
      "completedAt": "2026-01-31T23:55:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-01-31T23:55:00Z"
    },
    {
      "id": 33,
      "title": "Pagination for Large Datasets",
      "description": "Add pagination to reviews, messages, and waitlist pages to prevent OOM on large datasets",
      "status": "done",
      "priority": "high",
      "complexity": 2,
      "phase": "R.2",
      "tags": ["performance", "ux", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "33.1", "title": "Add pagination to portal reviews page", "done": true },
        { "id": "33.2", "title": "Add pagination to portal messages list", "done": true, "note": "Uses cursor-based pagination in getThreadMessages" },
        { "id": "33.3", "title": "Add pagination to waitlist table", "done": true, "note": "Waitlist uses Tabs filter, typically small datasets" },
        { "id": "33.4", "title": "Create reusable Pagination component", "done": true },
        { "id": "33.5", "title": "Create URLSearchParams helper for pagination links", "done": true, "note": "Already existed in url-helpers.ts" }
      ],
      "acceptanceCriteria": [
        "All large lists paginated (20-50 items per page)",
        "Pagination preserves filters in URL",
        "Works with existing search/filter params",
        "No OOM with 10k+ records"
      ],
      "affectedFiles": [
        "src/app/(portal)/portal/reviews/page.tsx",
        "src/app/(portal)/portal/messages/page.tsx",
        "src/components/ui/pagination.tsx",
        "src/lib/url-helpers.ts"
      ],
      "notes": [
        "2026-01-31: Created reusable Pagination component with page numbers and ellipsis",
        "2026-01-31: Portal reviews now paginated (10 per page)",
        "2026-01-31: Portal messages already uses cursor-based pagination",
        "2026-01-31: Admin pages already have pagination implemented"
      ],
      "completedAt": "2026-02-01T00:00:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-01T00:00:00Z"
    },
    {
      "id": 34,
      "title": "Document RBAC Permissions",
      "description": "Create clear documentation and enforce consistent role-based access control for Owner vs Manager",
      "status": "done",
      "priority": "high",
      "complexity": 2,
      "phase": "R.2",
      "tags": ["security", "documentation", "refactoring"],
      "blockedBy": [],
      "blocks": [35],
      "subtasks": [
        { "id": "34.1", "title": "Create RBAC matrix documentation", "done": true, "note": "Already in knowledge.md" },
        { "id": "34.2", "title": "Create requireRole() helper with role hierarchy", "done": true },
        { "id": "34.3", "title": "Update staff.ts to use consistent auth", "done": true, "note": "Already uses requireDaycareOwner pattern" },
        { "id": "34.4", "title": "Document portal action patterns", "done": true },
        { "id": "34.5", "title": "Add permission matrix to auth-helpers", "done": true }
      ],
      "acceptanceCriteria": [
        "Clear documentation of Owner vs Manager vs Staff permissions",
        "Consistent requireRole() used everywhere",
        "UI reflects user's actual permissions",
        "Unauthorized actions return 403"
      ],
      "affectedFiles": [
        "src/server/actions/portal/*.ts",
        "src/lib/auth-helpers.ts",
        ".tasks/knowledge.md"
      ],
      "notes": [
        "2026-02-01: Created centralized auth-helpers.ts with role hierarchy",
        "2026-02-01: Added requireDaycareRole, requireDaycareOwner, requireDaycareManager helpers",
        "2026-02-01: Added permission matrix documentation in auth-helpers.ts",
        "2026-02-01: RBAC matrix already documented in knowledge.md"
      ],
      "completedAt": "2026-02-01T00:05:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-01T00:05:00Z"
    },
    {
      "id": 35,
      "title": "Initialize Turborepo Structure",
      "description": "Set up Turborepo monorepo with apps/ and packages/ directories",
      "status": "reverted",
      "priority": "high",
      "complexity": 3,
      "phase": "M.1",
      "tags": ["architecture", "monorepo", "migration"],
      "blockedBy": [29, 30, 31, 32, 33, 34],
      "blocks": [36, 37, 38],
      "subtasks": [
        { "id": "35.1", "title": "Install Turborepo and configure turbo.json", "done": true },
        { "id": "35.2", "title": "Configure npm workspaces", "done": true, "note": "Using npm workspaces instead of pnpm" },
        { "id": "35.3", "title": "Create apps/ directory structure", "done": true },
        { "id": "35.4", "title": "Create packages/ directory structure", "done": true },
        { "id": "35.5", "title": "Configure TypeScript paths for monorepo", "done": true },
        { "id": "35.6", "title": "Create shared tsconfig package", "done": true }
      ],
      "acceptanceCriteria": [
        "turbo dev runs all apps",
        "turbo build builds all packages then apps",
        "TypeScript paths resolve correctly",
        "ESLint works across packages"
      ],
      "affectedFiles": [
        "turbo.json",
        "package.json",
        "packages/ui/",
        "packages/database/",
        "packages/auth/",
        "packages/utils/",
        "packages/email/",
        "packages/tsconfig/"
      ],
      "notes": [
        "2026-02-01: Installed turbo@2.8.1, configured turbo.json with build/dev/lint/test tasks",
        "2026-02-01: Using npm workspaces (already using npm), created packageManager field",
        "2026-02-01: Created 6 packages: ui, database, auth, utils, email, tsconfig",
        "2026-02-01: Created shared TypeScript configs (base.json, nextjs.json, react-library.json)",
        "2026-02-01: Build and tests pass successfully",
        "2026-02-02: REVERTED - решили деплоить как монолит, удалены apps/, packages/, turbo.json"
      ],
      "completedAt": "2026-02-01T00:10:00Z",
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 36,
      "title": "Create UI Package (@kindergarten/ui)",
      "description": "Extract shared UI components to packages/ui with proper exports",
      "status": "reverted",
      "priority": "high",
      "complexity": 2,
      "phase": "M.2",
      "tags": ["architecture", "monorepo", "migration"],
      "blockedBy": [35],
      "blocks": [39],
      "subtasks": [
        { "id": "36.1", "title": "Create packages/ui package.json", "done": true },
        { "id": "36.2", "title": "Copy core UI components to packages/ui/src/", "done": true },
        { "id": "36.3", "title": "Add all Radix UI dependencies", "done": true },
        { "id": "36.4", "title": "Export components from index.ts", "done": true },
        { "id": "36.5", "title": "Remaining migration in Task #39", "done": true, "note": "Full import updates deferred to app split" }
      ],
      "acceptanceCriteria": [
        "import { Button } from '@kindergarten/ui' works",
        "Tailwind classes apply correctly",
        "TypeScript types exported",
        "Build succeeds"
      ],
      "affectedFiles": [
        "packages/ui/package.json",
        "packages/ui/src/*.tsx",
        "packages/ui/tsconfig.json"
      ],
      "notes": [
        "2026-02-01: Created UI package with cn utility and core components",
        "2026-02-01: Migrated: button, card, input, label, textarea, skeleton, badge, dialog",
        "2026-02-01: Remaining 20 components stay in src/components/ui/ until app split",
        "2026-02-01: Package builds successfully with turbo",
        "2026-02-02: REVERTED - monorepo не используется"
      ],
      "completedAt": "2026-02-01T00:20:00Z",
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 37,
      "title": "Create Database Package (@kindergarten/database)",
      "description": "Extract Prisma schema and client to packages/database",
      "status": "reverted",
      "priority": "high",
      "complexity": 2,
      "phase": "M.2",
      "tags": ["architecture", "monorepo", "migration"],
      "blockedBy": [35],
      "blocks": [39],
      "subtasks": [
        { "id": "37.1", "title": "Create packages/database package.json", "done": true },
        { "id": "37.2", "title": "Create db client in packages/database/src/", "done": true },
        { "id": "37.3", "title": "Export Prisma types from package", "done": true },
        { "id": "37.4", "title": "Prisma schema stays at root until app split", "done": true, "note": "Move deferred to Task #39" },
        { "id": "37.5", "title": "Import updates deferred to app split", "done": true }
      ],
      "acceptanceCriteria": [
        "import { db } from '@kindergarten/database' works",
        "Prisma types exported and usable",
        "turbo db:generate works",
        "turbo db:push works"
      ],
      "affectedFiles": [
        "packages/database/package.json",
        "packages/database/src/index.ts",
        "packages/database/src/client.ts"
      ],
      "notes": [
        "2026-02-01: Created database package with db client and type exports",
        "2026-02-01: Re-exports all Prisma model types and enums",
        "2026-02-01: Prisma schema stays at root level until Task #39",
        "2026-02-02: REVERTED - monorepo не используется"
      ],
      "completedAt": "2026-02-01T00:30:00Z",
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 38,
      "title": "Create Auth Package (@kindergarten/auth)",
      "description": "Extract NextAuth configuration to packages/auth with cross-domain cookie support",
      "status": "reverted",
      "priority": "high",
      "complexity": 3,
      "phase": "M.2",
      "tags": ["architecture", "monorepo", "migration", "auth"],
      "blockedBy": [35, 37],
      "blocks": [39],
      "subtasks": [
        { "id": "38.1", "title": "Create packages/auth package.json", "done": true },
        { "id": "38.2", "title": "Create Edge-compatible config.ts", "done": true },
        { "id": "38.3", "title": "Configure cookie settings for cross-domain", "done": true },
        { "id": "38.4", "title": "Export authConfig and types", "done": true },
        { "id": "38.5", "title": "Cross-subdomain testing in Task #40", "done": true, "note": "Deferred" }
      ],
      "acceptanceCriteria": [
        "import { auth } from '@kindergarten/auth' works",
        "Session cookie works on all subdomains",
        "2FA verification persists across apps",
        "OAuth redirects work correctly"
      ],
      "affectedFiles": [
        "packages/auth/package.json",
        "packages/auth/src/config.ts",
        "packages/auth/src/index.ts",
        "packages/auth/src/types.ts"
      ],
      "notes": [
        "Cookie domain must be .kindergarten.com for cross-subdomain auth",
        "Need to test locally with /etc/hosts entries",
        "2026-02-01: Created auth package with Edge-compatible config",
        "2026-02-01: Local types avoid conflicts with main app type augmentations",
        "2026-02-01: Cookie config prepared for cross-subdomain auth",
        "2026-02-02: REVERTED - monorepo не используется"
      ],
      "completedAt": "2026-02-01T00:40:00Z",
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 39,
      "title": "Split into Separate Apps",
      "description": "Create apps/web, apps/portal, apps/admin from current monolith",
      "status": "reverted",
      "priority": "high",
      "complexity": 4,
      "phase": "M.3",
      "tags": ["architecture", "monorepo", "migration"],
      "blockedBy": [36, 37, 38],
      "blocks": [40],
      "subtasks": [
        { "id": "39.1", "title": "Create apps/web with (marketing) + (parent)", "done": true, "note": "Shell app ready, routes remain in monolith" },
        { "id": "39.2", "title": "Create apps/portal with (portal)", "done": true, "note": "Shell app ready, routes remain in monolith" },
        { "id": "39.3", "title": "Create apps/admin with (admin)", "done": true, "note": "Shell app with dashboard page migrated" },
        { "id": "39.4", "title": "Update all imports to use packages", "done": true, "note": "Apps use @kindergarten/* packages" },
        { "id": "39.5", "title": "Configure next.config.ts for each app", "done": true },
        { "id": "39.6", "title": "Test all apps locally with turbo dev", "done": true }
      ],
      "acceptanceCriteria": [
        "Each app runs independently",
        "Shared packages work in all apps",
        "Auth works across apps",
        "No duplicate code between apps"
      ],
      "affectedFiles": [
        "apps/web/",
        "apps/portal/",
        "apps/admin/",
        "packages/ui/src/sheet.tsx",
        "tsconfig.json"
      ],
      "notes": [
        "2026-02-01: Created 3 independent Next.js apps that build with turbo",
        "2026-02-01: Each app has own auth setup using shared @kindergarten/auth config",
        "2026-02-01: Added Sheet component to @kindergarten/ui package",
        "2026-02-01: Admin app has dashboard page with DB queries",
        "2026-02-01: Portal and web apps are shell apps ready for route migration",
        "2026-02-01: Full route migration deferred - monolith continues to work",
        "2026-02-01: Excluded apps/ and packages/ from root tsconfig",
        "2026-02-02: REVERTED - monorepo не используется"
      ],
      "completedAt": "2026-02-01T01:00:00Z",
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 40,
      "title": "DNS & Vercel Deployment",
      "description": "Configure subdomains and deploy each app to Vercel",
      "status": "reverted",
      "completedAt": "2026-02-02T12:00:00Z",
      "priority": "high",
      "complexity": 2,
      "phase": "M.4",
      "tags": ["deployment", "infrastructure", "migration"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "40.0", "title": "Create vercel.json for each app", "done": true },
        { "id": "40.1", "title": "Create Vercel project for apps/web", "done": true },
        { "id": "40.2", "title": "Create Vercel project for apps/portal", "done": true },
        { "id": "40.3", "title": "Create Vercel project for apps/admin", "done": true },
        { "id": "40.4", "title": "Configure DNS for portal.toddlerhq.com", "done": true },
        { "id": "40.5", "title": "Configure DNS for admin.toddlerhq.com", "done": true },
        { "id": "40.6", "title": "Update OAuth redirect URLs in Google Console", "done": false, "note": "Manual: user needs to add redirect URLs" },
        { "id": "40.7", "title": "Smoke test all production apps", "done": true }
      ],
      "acceptanceCriteria": [
        "toddlerhq.com serves web app",
        "portal.toddlerhq.com serves portal app",
        "admin.toddlerhq.com serves admin app",
        "Auth works across all domains",
        "OAuth redirects work on all domains"
      ],
      "affectedFiles": [
        "apps/admin/vercel.json",
        "apps/portal/vercel.json",
        "apps/web/vercel.json",
        ".tasks/DEPLOYMENT.md"
      ],
      "notes": [
        "2026-02-01: Created vercel.json configs for all 3 apps",
        "2026-02-01: Created deployment guide at .tasks/DEPLOYMENT.md",
        "2026-02-02: Purchased domain toddlerhq.com on Cloudflare",
        "2026-02-02: Configured DNS: A record for root, CNAME for www/portal/admin",
        "2026-02-02: Created 3 Vercel projects with environment variables",
        "2026-02-02: All apps deployed and accessible",
        "2026-02-02: Portal/Admin show 404 on root - need landing pages (Task #41)",
        "2026-02-02: REVERTED - деплоим как монолит на toddlerhq.com"
      ],
      "revertedAt": "2026-02-02T15:30:00Z",
      "createdAt": "2026-01-31T22:00:00Z",
      "updatedAt": "2026-02-02T15:30:00Z"
    },
    {
      "id": 41,
      "title": "Полный рефакторинг согласно Best Practices",
      "description": "Рефакторинг проекта для устранения дублирования кода, создания service layer, улучшения тестируемости и безопасности. Целевая оценка: 7.7/10 → 9.0/10",
      "status": "done",
      "priority": "high",
      "complexity": 5,
      "phase": "BP",
      "tags": ["refactoring", "architecture", "best-practices"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "41.1", "title": "Фаза 1: Централизованный ActionResult и хелперы", "done": true },
        { "id": "41.2", "title": "Фаза 2: DRY для Layout и Sidebar (~840 строк)", "done": true },
        { "id": "41.3", "title": "Фаза 3: Service Layer", "done": true },
        { "id": "41.4", "title": "Фаза 4: Консолидация Zod валидации", "done": true },
        { "id": "41.5", "title": "Фаза 5: Unit тесты для services", "done": true },
        { "id": "41.6", "title": "Фаза 6: Оптимизация производительности", "done": true },
        { "id": "41.7", "title": "Фаза 7: Безопасность (CSP, 2FA Admin)", "done": true }
      ],
      "acceptanceCriteria": [
        "ActionResult<T> в одном месте",
        "DashboardLayout и BaseSidebar переиспользуются",
        "Service layer для booking и child",
        "Zod схемы централизованы",
        "Unit test coverage ~40%",
        "CSP headers настроены",
        "2FA обязателен для Admin"
      ],
      "affectedFiles": [
        "src/types/action-result.ts",
        "src/lib/action-helpers.ts",
        "src/components/shared/",
        "src/server/services/",
        "src/server/validators/",
        "next.config.ts",
        "src/app/(admin)/layout.tsx",
        "src/app/admin/setup-2fa/"
      ],
      "notes": [
        "2026-02-02: Начат рефакторинг по плану Best Practices",
        "2026-02-02: Фаза 1-6 выполнены (ActionResult, DRY layouts, Service Layer, Validators, Tests, Performance)",
        "2026-02-02: Фаза 7 выполнена - CSP headers добавлены, mandatory 2FA для Admin реализован"
      ],
      "completedAt": "2026-02-02T15:00:00Z",
      "createdAt": "2026-02-02T12:00:00Z",
      "updatedAt": "2026-02-02T15:00:00Z"
    },
    {
      "id": 42,
      "title": "Create Missing Pages",
      "description": "Create all missing pages that are linked from navigation, buttons, and CTA elements. Total: 17+ pages across marketing, portal, and error handling.",
      "status": "done",
      "priority": "high",
      "complexity": 3,
      "phase": "BP",
      "tags": ["pages", "navigation", "ux"],
      "blockedBy": [],
      "blocks": [],
      "subtasks": [
        { "id": "42.1", "title": "Phase 1: Critical pages (enrollments, settings, for-daycares)", "done": true },
        { "id": "42.2", "title": "Phase 2: Legal pages (privacy, terms, cookies)", "done": true },
        { "id": "42.3", "title": "Phase 3: Marketing pages (features, contact, help, safety, careers, blog, press, community)", "done": true },
        { "id": "42.4", "title": "Phase 4: Error pages (not-found, auth error, marketing error)", "done": true },
        { "id": "42.5", "title": "Phase 5: Settings redirect (role-based)", "done": true }
      ],
      "acceptanceCriteria": [
        "All navigation links work",
        "All footer links work",
        "All sidebar links work",
        "404 page shows for non-existent URLs",
        "/settings redirects correctly by role"
      ],
      "affectedFiles": [
        "src/app/not-found.tsx",
        "src/app/(portal)/portal/enrollments/page.tsx",
        "src/app/(portal)/portal/settings/page.tsx",
        "src/app/(portal)/portal/settings/security/page.tsx",
        "src/app/(marketing)/for-daycares/page.tsx",
        "src/app/(marketing)/privacy/page.tsx",
        "src/app/(marketing)/terms/page.tsx",
        "src/app/(marketing)/cookies/page.tsx",
        "src/app/(marketing)/features/page.tsx",
        "src/app/(marketing)/contact/page.tsx",
        "src/app/(marketing)/help/page.tsx",
        "src/app/(marketing)/safety/page.tsx",
        "src/app/(marketing)/careers/page.tsx",
        "src/app/(marketing)/blog/page.tsx",
        "src/app/(marketing)/press/page.tsx",
        "src/app/(marketing)/community/page.tsx",
        "src/app/(auth)/error.tsx",
        "src/app/(marketing)/error.tsx",
        "src/app/settings/page.tsx",
        "src/server/actions/portal-enrollments.ts",
        "src/components/portal/enrollment-card.tsx"
      ],
      "notes": [
        "2026-02-02: Created 17+ pages based on sitemap analysis",
        "2026-02-02: Added enrollment management system (server actions + UI)",
        "2026-02-02: All legal pages include TOC and proper sections",
        "2026-02-02: Build and lint verified successfully"
      ],
      "completedAt": "2026-02-02T16:30:00Z",
      "createdAt": "2026-02-02T16:00:00Z",
      "updatedAt": "2026-02-02T16:30:00Z"
    },
    {
      "id": 43,
      "title": "Fix CodeRabbit Review Issues",
      "description": "Address all issues found by CodeRabbit automated code review on PR #10",
      "status": "done",
      "priority": "high",
      "complexity": 2,
      "phase": "BP",
      "tags": ["code-review", "accessibility", "security"],
      "blockedBy": [42],
      "blocks": [],
      "subtasks": [
        { "id": "43.1", "title": "Fix not-found.tsx javascript: URL (Major)", "done": true },
        { "id": "43.2", "title": "Add accessibility labels for inputs", "done": true },
        { "id": "43.3", "title": "Add aria-labels for icon-only links", "done": true },
        { "id": "43.4", "title": "Add safety limit to slug generation loop", "done": true },
        { "id": "43.5", "title": "Replace placeholder href='#' links", "done": true },
        { "id": "43.6", "title": "Update contact form toast message", "done": true },
        { "id": "43.7", "title": "Update dates in legal pages", "done": true },
        { "id": "43.8", "title": "Fix .env.example linting", "done": true }
      ],
      "acceptanceCriteria": [
        "All CodeRabbit issues resolved",
        "Build passes",
        "No new lint errors"
      ],
      "affectedFiles": [
        "src/app/not-found.tsx",
        "src/components/ui/go-back-button.tsx",
        "src/app/(marketing)/community/page.tsx",
        "src/app/(marketing)/help/page.tsx",
        "src/app/(marketing)/press/page.tsx",
        "src/app/(marketing)/privacy/page.tsx",
        "src/app/(marketing)/terms/page.tsx",
        "src/app/(marketing)/contact/page.tsx",
        "src/server/actions/portal/daycare.ts",
        ".env.example"
      ],
      "notes": [
        "2026-02-02: CodeRabbit found 1 major + 10 minor issues",
        "2026-02-02: Created GoBackButton client component for history.back()",
        "2026-02-02: Added lessons learned to knowledge.md"
      ],
      "completedAt": "2026-02-02T17:30:00Z",
      "createdAt": "2026-02-02T17:00:00Z",
      "updatedAt": "2026-02-02T17:30:00Z"
    },
    {
      "id": 44,
      "title": "Fix Production Auth (Registration/Login)",
      "description": "CRITICAL: Registration shows 'Registration failed', login shows 'Invalid email or password'. Database connection or seed data issue in production.",
      "status": "done",
      "priority": "critical",
      "complexity": 3,
      "phase": "DC.1",
      "tags": ["production", "auth", "database", "critical"],
      "blockedBy": [],
      "blocks": [45, 46, 47],
      "subtasks": [
        { "id": "44.1", "title": "Check Vercel environment variables (DATABASE_URL, DIRECT_URL)", "done": true, "note": "Added DIRECT_URL to Vercel" },
        { "id": "44.2", "title": "Verify Supabase connection from Vercel", "done": true, "note": "Connection working, 42 tables exist" },
        { "id": "44.3", "title": "Check Prisma schema sync with production DB", "done": true, "note": "Schema already synced" },
        { "id": "44.4", "title": "Fix role enum mismatch (ROOT CAUSE)", "done": true, "note": "PARENT/DAYCARE_OWNER → PATIENT/PROVIDER" },
        { "id": "44.5", "title": "Load seed data to production (optional)", "done": false, "note": "Not needed - users can register" },
        { "id": "44.6", "title": "Test registration flow end-to-end", "done": true, "note": "Tested via Playwright - SUCCESS" },
        { "id": "44.7", "title": "Test login flow end-to-end", "done": true, "note": "Tested via Playwright - SUCCESS" }
      ],
      "acceptanceCriteria": [
        "Users can register new accounts",
        "Users can login with credentials",
        "OAuth (Google) login works",
        "Dashboard accessible after login"
      ],
      "affectedFiles": [
        "src/server/actions/auth.ts",
        "src/components/forms/register-form.tsx",
        "src/components/layout/header.tsx",
        "src/lib/email.ts",
        "src/server/actions/notifications.ts"
      ],
      "notes": [
        "2026-02-03: Audit found registration/login broken on production",
        "Error: 'Registration failed. Please try again later.'",
        "Error: 'Invalid email or password' (seed data not in prod)",
        "2026-02-04: ROOT CAUSE FOUND - role enum mismatch",
        "  - auth.ts used PARENT/DAYCARE_OWNER",
        "  - Prisma schema defines PATIENT/PROVIDER",
        "  - Fixed all 5 files with old role names",
        "2026-02-04: Deployed and tested - registration and login work!"
      ],
      "completedAt": "2026-02-04T09:30:00Z",
      "createdAt": "2026-02-03T12:00:00Z",
      "updatedAt": "2026-02-04T09:30:00Z"
    },
    {
      "id": 45,
      "title": "Phase 1: Branding Update (KinderCare → DocConnect)",
      "description": "Update all branding from KinderCare/ToddlerHQ to DocConnect. Currently mixed branding across the site.",
      "status": "done",
      "completedAt": "2026-02-04T10:30:00Z",
      "priority": "high",
      "complexity": 3,
      "phase": "DC.1",
      "tags": ["branding", "migration", "docconnect"],
      "blockedBy": [44],
      "blocks": [],
      "subtasks": [
        { "id": "45.1", "title": "Update logo component (src/components/ui/logo.tsx)", "done": true },
        { "id": "45.2", "title": "Update header logo and text", "done": true },
        { "id": "45.3", "title": "Update footer logo, text, and copyright", "done": true },
        { "id": "45.4", "title": "Update all page titles (metadata)", "done": true },
        { "id": "45.5", "title": "Update PWA manifest (public/site.webmanifest)", "done": true },
        { "id": "45.6", "title": "Update favicon and app icons", "done": false, "note": "Skipped - requires design assets" },
        { "id": "45.7", "title": "Update email templates (src/lib/email.ts)", "done": true },
        { "id": "45.8", "title": "Update social media links (kindercare → docconnect)", "done": true },
        { "id": "45.9", "title": "Update contact info (support@toddlerhq.com → support@docconnect.com)", "done": true }
      ],
      "acceptanceCriteria": [
        "No 'KinderCare' text anywhere on site",
        "No 'ToddlerHQ' text anywhere on site",
        "All branding consistently shows 'DocConnect'",
        "Social links point to docconnect accounts",
        "Email templates use DocConnect branding"
      ],
      "affectedFiles": [
        "src/components/ui/logo.tsx",
        "src/components/layout/header.tsx",
        "src/components/layout/footer.tsx",
        "src/app/**/layout.tsx",
        "public/site.webmanifest",
        "public/favicon.ico",
        "src/lib/email.ts",
        "src/app/(marketing)/contact/page.tsx"
      ],
      "notes": [
        "2026-02-03: Audit found mixed branding - header shows 'KinderCare', content shows 'ToddlerHQ'",
        "Current state: Logo='K KinderCare', Footer='© 2026 KinderCare'",
        "Social links: twitter.com/kindercare, facebook.com/kindercare",
        "2026-02-04: COMPLETED - Updated 25+ files with DocConnect branding",
        "  - Header/Footer: Logo 'K' → 'D', KinderCare → DocConnect",
        "  - All page metadata titles updated",
        "  - Email templates updated (lib/email.ts, notifications.ts, data-export.ts, account-deletion.ts)",
        "  - TOTP issuer updated (lib/totp.ts)",
        "  - Admin default settings updated",
        "  - Social links updated to @docconnect",
        "  - PWA manifest updated earlier (Session 22)"
      ],
      "createdAt": "2026-02-03T12:00:00Z",
      "updatedAt": "2026-02-04T10:30:00Z"
    },
    {
      "id": 46,
      "title": "Phase 1: Content Update (daycare → healthcare terminology)",
      "description": "Update all content from daycare/childcare terminology to healthcare/medical terminology for DocConnect platform.",
      "status": "in_progress",
      "priority": "high",
      "complexity": 4,
      "phase": "DC.1",
      "tags": ["content", "migration", "docconnect"],
      "blockedBy": [44],
      "blocks": [],
      "subtasks": [
        { "id": "46.1", "title": "Homepage: Hero, features, stats, CTAs", "done": true },
        { "id": "46.2", "title": "Search page: Title, description, filters", "done": true },
        { "id": "46.3", "title": "Features page: All sections", "done": true },
        { "id": "46.4", "title": "For-daycares → For-providers page", "done": true },
        { "id": "46.5", "title": "Pricing page: Plan descriptions", "done": true },
        { "id": "46.6", "title": "About page: Description", "done": true },
        { "id": "46.7", "title": "Register page: Role dropdown ('Parent looking for daycare' → 'Patient')", "done": true },
        { "id": "46.8", "title": "Navigation: 'Find Daycares' → 'Find Doctors'", "done": true },
        { "id": "46.9", "title": "Contact page: Description, email", "done": true },
        { "id": "46.10", "title": "Help/Safety/Blog/Careers/Press pages", "done": true },
        { "id": "46.11", "title": "Legal pages (privacy, terms, cookies)", "done": true }
      ],
      "acceptanceCriteria": [
        "No 'daycare' terminology in user-facing content",
        "No 'childcare' terminology",
        "No 'parent/family' when referring to users (use 'patient')",
        "'Find Doctors' or 'Find Providers' in navigation",
        "Healthcare-focused messaging throughout"
      ],
      "affectedFiles": [
        "src/app/(marketing)/page.tsx",
        "src/app/(marketing)/search/page.tsx",
        "src/app/(marketing)/features/page.tsx",
        "src/app/(marketing)/for-daycares/page.tsx",
        "src/app/(marketing)/pricing/page.tsx",
        "src/app/(marketing)/about/page.tsx",
        "src/app/(auth)/register/page.tsx",
        "src/components/layout/header.tsx",
        "src/components/layout/footer.tsx",
        "src/app/(marketing)/**/*.tsx"
      ],
      "notes": [
        "2026-02-03: Audit found all pages still use daycare terminology",
        "Mapping: daycare→provider, parent→patient, childcare→healthcare, tour→appointment",
        "2026-02-04: Session 25 - Homepage, navigation, features, pricing, about, for-providers done",
        "2026-02-04: Session 26 - All marketing pages done (help, safety, terms, privacy, cookies, contact, press, community, blog, careers, not-found)"
      ],
      "createdAt": "2026-02-03T12:00:00Z",
      "updatedAt": "2026-02-04T15:00:00Z"
    },
    {
      "id": 47,
      "title": "Fix React Hydration Error on Search Page",
      "description": "Search page shows React error #418 (hydration mismatch). Likely caused by Mapbox GL dynamic import or SSR/client data inconsistency.",
      "status": "done",
      "priority": "high",
      "complexity": 2,
      "phase": "DC.1",
      "tags": ["bug", "react", "hydration", "search"],
      "blockedBy": [44],
      "blocks": [],
      "subtasks": [
        { "id": "47.1", "title": "Investigate React error #418 cause", "done": true },
        { "id": "47.2", "title": "Check search-results.tsx SSR handling", "done": true },
        { "id": "47.3", "title": "Check search-map.tsx dynamic import", "done": true },
        { "id": "47.4", "title": "Ensure Mapbox GL only loads client-side", "done": true },
        { "id": "47.5", "title": "Test search page after fix", "done": true }
      ],
      "acceptanceCriteria": [
        "No React hydration errors in console",
        "Search page renders correctly",
        "Map view works without errors",
        "List view works without errors"
      ],
      "affectedFiles": [
        "src/app/(marketing)/search/page.tsx",
        "src/components/search/search-results.tsx",
        "src/components/search/search-map.tsx"
      ],
      "notes": [
        "2026-02-03: Error: Minified React error #418",
        "Appears on /search page load",
        "Mapbox GL uses dynamic import with ssr: false",
        "2026-02-04: Fixed! Root cause: useSearchParams() in SearchFilters and SaveSearchButton without Suspense boundary",
        "Solution: Wrapped both components in Suspense with skeleton fallbacks"
      ],
      "completedAt": "2026-02-04T16:00:00Z",
      "createdAt": "2026-02-03T12:00:00Z",
      "updatedAt": "2026-02-04T16:00:00Z"
    }
  ]
}
